var Environments;!function(t){t[t.Node=0]="Node",t[t.Standalone=1]="Standalone",t[t.Proxy=2]="Proxy"}(Environments||(Environments={}));var WapCom;!function(t){"use strict";var e=function(){function t(){if(this._environment=Environments.Standalone,t._instance)throw new Error("Error: Instantiation failed: Use Environment.getInstance() instead of new.");this.ResetEnvironment(),t._instance=this}return Object.defineProperty(t.prototype,"CurrentEnvironment",{get:function(){return this._environment},enumerable:!0,configurable:!0}),t.getInstance=function(){return t._instance},t.prototype.ResetEnvironment=function(){this._environment=this.SetEnvironment()},t.prototype.SetEnvironment=function(){try{return window.external.notify(t._testParameter),Environments.Node}catch(e){return Environments.Standalone}},t._testParameter="Test",t._instance=new t,t}();t.Environment=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict"}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict"}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict"}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict"}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function t(){}return t.JoinOnSep=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.join(t)},t.Join=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return t.join("")},t.Query=function(t){var e="?",n=0;for(var o in t)t.hasOwnProperty(o)&&(n++&&(e+="&"),e+=encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return e},t}();t.Path=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e;!function(t){t[t.Pending=0]="Pending",t[t.Resolved=1]="Resolved",t[t.Rejected=2]="Rejected"}(e||(e={}));var n=function(){function t(t){this._state=e.Pending,this._value=null,this._handlers=[],this.DoResolve(t)}return t.prototype.then=function(e,n,o){var r=this;return new t(function(t,o){return r.done(function(n){if("function"!=typeof e)return t(n);try{return t(e(n))}catch(r){return o(r)}},function(e){if("function"!=typeof n)return o(e);try{return t(n(e))}catch(r){return o(r)}})})},t.prototype.done=function(t,e,n){var o=this;setTimeout(function(){o.Handle({onResolved:t,onRejected:e})},0)},t.prototype.cancel=function(){},t.prototype.OnFullFilled=function(t){var n=this;this._state=e.Resolved,this._value=t,this._handlers.forEach(function(t){n.Handle(t)}),this._handlers=null},t.prototype.OnRejected=function(t){var n=this;this._state=e.Rejected,this._value=t,this._handlers.forEach(function(t){n.Handle(t)}),this._handlers=null},t.prototype.Resolve=function(t){try{var e=this.GetThen(t);if(e)return void this.DoResolve(e.bind(t));this.OnFullFilled(t)}catch(n){this.OnRejected(n)}},t.prototype.Handle=function(t){this._state===e.Pending?this._handlers.push(t):(this._state===e.Resolved&&"function"==typeof t.onResolved&&t.onResolved(this._value),this._state===e.Rejected&&"function"==typeof t.onRejected&&t.onRejected(this._value))},t.prototype.DoResolve=function(t){var e=this,n=!1;try{t(function(t){n||(n=!0,e.Resolve(t))},function(t){n||(n=!0,e.OnRejected(t))})}catch(o){if(n)return;n=!0,this.OnRejected(o)}},t.prototype.GetThen=function(t){var e=typeof t;if(t&&("object"===e||"function"===e)){var n=t.then;if("function"==typeof n)return n}return null},t}();t.PromiseAdapter=n;var o=function(){function t(t){this._simValue=t}return t.prototype.then=function(t,e,n){return t(this._simValue),null},t.prototype.done=function(t,e,n){return t(this._simValue),null},t.prototype.cancel=function(){},t}();t.PromiseSimulator=o}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function t(t,e){this.key=t,this.value=e}return t}();t.Configuration=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function t(t,e){this.Key=t,this.EventObject=e}return t}();t.Event=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function t(){}return t.prototype.setLocation=function(t,e){this.coordinates||(this.coordinates=new n),this.coordinates.setLocation(t,e)},t.prototype.setPosition=function(t){this.coordinates||(this.coordinates=new n),this.coordinates.setPosition(t)},t}();t.Location=e;var n=function(){function t(){}return t.prototype.setLocation=function(t,e){this.latitude=t?JSON.stringify(t):"0",this.longitude=e?JSON.stringify(e):"0"},t.prototype.setPosition=function(t){this.latitude="0",this.longitude="0",t&&t.coords&&(this.latitude=t.coords.latitude,this.longitude=t.coords.longitude)},t}();t.Coordinates=n;var o=function(){function t(){}return t}();t.Structure=o}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function e(){}return e.GetConfigurations=function(){return t.Environment.getInstance().CurrentEnvironment==Environments.Node?e.nodeGet():e.standaloneGet()},e.standaloneGet=function(){return new t.PromiseAdapter(function(e,n){for(var o=[],r=window.location.search.substr(1),i=r.split("&"),s=0;s<i.length;s++){var a=i[s].split("=");o.push(new t.Configuration(a[0],a[1]))}e(o)})},e.nodeGet=function(){return new t.PromiseAdapter(function(t,e){try{if(!configurationHandler)throw new Error("Unable to get configurations, due to configurationHandler is null.");var n=configurationHandler.getConfigurations();t(n)}catch(o){e(o)}})},e}();t.ConfigProvider=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function e(){}return e.GetLocation=function(n,o){return void 0===n&&(n=15.64126),void 0===o&&(o=58.41659),t.Environment.getInstance().CurrentEnvironment==Environments.Node?e.nodeGetLocation(n,o):e.standaloneGetLocation(n,o)},e.standaloneGetLocation=function(e,n){return void 0===e&&(e=15.64126),void 0===n&&(n=58.41659),new t.PromiseAdapter(function(o,r){var i=new t.Location;i.setLocation(e,n),navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){i.setPosition(t),o(i)},function(t){switch(t.code){case t.PERMISSION_DENIED:o(i);case t.POSITION_UNAVAILABLE:r("Location information is unavailable.");case t.TIMEOUT:r("The request to get user location timed out.");default:r("An unknown error occurred.")}}):o(i)})},e.nodeGetLocation=function(e,n){if(void 0===e&&(e=15.64126),void 0===n&&(n=58.41659),!geoServiceHandler)throw new Error("Unable to get location, due to geoServiceHandler is null.");return new t.PromiseAdapter(function(t,e){try{var n=geoServiceHandler.getLocation();t(n)}catch(o){e(o)}})},e}();t.GeoProvider=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function e(t,e){this.Validate(t,e),this._key=e,this._name=t}return Object.defineProperty(e.prototype,"Key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.Get=function(e,n,o,r,i){return new t.PromiseSimulator("Get success")},e.prototype.GetOne=function(e,n){return new t.PromiseSimulator("GetOne success")},e.prototype.Post=function(e,n){return new t.PromiseSimulator("Post success")},e.prototype.Put=function(e,n,o){return new t.PromiseSimulator("Put success")},e.prototype.Delete=function(e,n){return new t.PromiseSimulator("true")},e.prototype.Validate=function(t,e){if(!t||""==t)throw new Error("Invalid name, please fill out correct name");if(!e||""==e)throw new Error("Invalid key, please fill out correct key")},e}();t.ServiceClient=e}(WapCom||(WapCom={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},WapCom;!function(t){"use strict";var e=function(t){function e(e,n,o){t.call(this,e,n);var r=this.TryToGetServiceHandler();this._serviceProxy=r.getService(this.Name,this.Key)}return __extends(e,t),e.prototype.Get=function(t,e,n,o,r){return this._serviceProxy.get(t,e,n,o,r)},e.prototype.GetOne=function(t,e){return this._serviceProxy.getOne(t,e)},e.prototype.Post=function(t,e){return this._serviceProxy.post(t,e)},e.prototype.Put=function(t,e,n){return this._serviceProxy.put(t,e,n)},e.prototype.Delete=function(t,e){return this._serviceProxy["delete"](t,e)},e.prototype.TryToGetServiceHandler=function(){if(!serviceHandler)throw new Error("Unable to create ServiceClient, due to servicehandler is null");return serviceHandler},e}(t.ServiceClient);t.NodeServiceClient=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(e){function n(t,n,o,r){void 0===o&&(o=""),e.call(this,t,n),this._servicePrefix="services",this._jsonContentType="application/json",this._requestAsync=!0,this.SetBasePath(o),this._keyToken=r}return __extends(n,e),n.prototype.Get=function(e,n,o,r,i){var s=this,a=t.Path.JoinOnSep("/",this._basePath,"types",e);return new t.PromiseAdapter(function(e,u){var c=s.CreateMethodRequest("GET",t.Path.Join(a,t.Path.Query({take:n,skip:o,orderBy:r,filter:i})));c.send(),s.OnXMLHttpRequestResponse(c,e,u)})},n.prototype.GetOne=function(e,n){var o=this;return new t.PromiseAdapter(function(r,i){var s=o.CreateMethodRequest("GET",t.Path.JoinOnSep("/",o._basePath,"types",e,n));s.send(),o.OnXMLHttpRequestResponse(s,r,i)})},n.prototype.Post=function(e,n){var o=this,r=t.Path.JoinOnSep("/",this._basePath,"types",e);return new t.PromiseAdapter(function(t,e){var i=o.CreateMethodJsonRequest("POST",r);i.send(n),o.OnXMLHttpRequestResponse(i,t,e)})},n.prototype.Put=function(e,n,o){var r=this;return new t.PromiseAdapter(function(i,s){var a=r.CreateMethodJsonRequest("PUT",t.Path.JoinOnSep("/",r._basePath,"types",e,n));a.send(o),r.OnXMLHttpRequestResponse(a,i,s)})},n.prototype.Delete=function(e,n){var o=this;return new t.PromiseAdapter(function(r,i){var s=o.CreateMethodRequest("DELETE",t.Path.JoinOnSep("/",o._basePath,"types",e,n));s.send(),o.OnXMLHttpRequestResponse(s,r,i)})},n.prototype.OnXMLHttpRequestResponse=function(t,e,n){var o=this.IsHttpStatusValid;t.onload=function(){o(this.status)?e(this.response):n(this.statusText)},t.onerror=function(){n(this.statusText)}},n.prototype.IsHttpStatusValid=function(t){return t>=200&&300>t},n.prototype.CreateRequest=function(){return new XMLHttpRequest},n.prototype.CreateMethodRequest=function(t,e){var n=this.CreateRequest();return n.open(t,e,this._requestAsync),n.setRequestHeader("X-Key",this.Key),n.setRequestHeader("Key-Token",this._keyToken),n},n.prototype.CreateMethodJsonRequest=function(t,e){var n=this.CreateMethodRequest(t,e);return n.setRequestHeader("Content-type",this._jsonContentType),n},n.prototype.SetBasePath=function(e){e&&(e=this.FilterUrl(e),this._basePath=-1===e.indexOf(this._servicePrefix)?t.Path.JoinOnSep("/",e,this._servicePrefix,this.Name):t.Path.JoinOnSep("/",e,this.Name))},n.prototype.FilterUrl=function(t){return t.replace(/\/$/,"").toLowerCase()},n}(t.ServiceClient);t.StandaloneServiceClient=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function e(){}return e.GetService=function(e,n,o){return void 0===o&&(o=null),null==this.keyToken&&(this.keyToken=""),t.Environment.getInstance().CurrentEnvironment==Environments.Node?new t.NodeServiceClient(e,n,this.keyToken):new t.StandaloneServiceClient(e,n,o,this.keyToken)},e.SetServiceKeyToken=function(t){this.keyToken=t},e}();t.ServiceProvider=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function t(t){this._trafficSettings=t}return t.prototype.onEventReceived=function(t){this._trafficSettings.onEventReceived&&"[object Function]"===Object.prototype.toString.call(this._trafficSettings.onEventReceived)&&this._trafficSettings.onEventReceived.call(this,t)},t}();t.TrafficWorker=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(t){function e(e){t.call(this,e),window.OutboundEvent=this.OutboundEvent.bind(this),window.InboundEvent=this.InboundEvent.bind(this)}return __extends(e,t),e.prototype.OutboundEvent=function(t){window.external.notify(t)},e.prototype.InboundEvent=function(e){var n=JSON.parse(e);t.prototype.onEventReceived.call(this,n)},e}(t.TrafficWorker);t.NodeTrafficWorker=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(t){function e(e){t.call(this,e)}return __extends(e,t),e.prototype.OutboundEvent=function(t){},e.prototype.InboundEvent=function(t){},e}(t.TrafficWorker);t.StandaloneTrafficWorker=e}(WapCom||(WapCom={}));var WapCom;!function(t){"use strict";var e=function(){function e(t){this.Worker=this.SetEnvironmentWorker(t)}return e.prototype.SendEvent=function(t,e){var n=this.CreateEvent(t,e);this.Worker.OutboundEvent(n)},e.prototype.RequestFocus=function(t){var n=this.CreateEvent(e._focusRequestParameter,t);this.Worker.OutboundEvent(n)},e.prototype.CreateEvent=function(e,n){var o=new t.Event(e,n);return JSON.stringify(o)},e.prototype.SetEnvironmentWorker=function(e){return t.Environment.getInstance().CurrentEnvironment==Environments.Node?new t.NodeTrafficWorker(e):new t.StandaloneTrafficWorker(e)},e._focusRequestParameter="FocusRequest",e}();t.TrafficManager=e}(WapCom||(WapCom={}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC1hcHBtb2Qtd2FwZ2VuLmpzIl0sIm5hbWVzIjpbIkVudmlyb25tZW50cyIsIldhcENvbSIsIkVudmlyb25tZW50IiwidGhpcyIsIl9lbnZpcm9ubWVudCIsIlN0YW5kYWxvbmUiLCJfaW5zdGFuY2UiLCJFcnJvciIsIlJlc2V0RW52aXJvbm1lbnQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInByb3RvdHlwZSIsImdldCIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJnZXRJbnN0YW5jZSIsIlNldEVudmlyb25tZW50Iiwid2luZG93IiwiZXh0ZXJuYWwiLCJub3RpZnkiLCJfdGVzdFBhcmFtZXRlciIsIk5vZGUiLCJlcnIiLCJQYXRoIiwiSm9pbk9uU2VwIiwic2VwZXJhdG9yIiwiYXJncyIsIl9pIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiam9pbiIsIkpvaW4iLCJRdWVyeSIsInF1ZXJ5IiwiYXJnY291bnQiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsImVuY29kZVVSSUNvbXBvbmVudCIsIlByb21pc2VTdGF0dXMiLCJQcm9taXNlQWRhcHRlciIsImNhbGxiYWNrIiwiX3N0YXRlIiwiUGVuZGluZyIsIl92YWx1ZSIsIl9oYW5kbGVycyIsIkRvUmVzb2x2ZSIsInRoZW4iLCJzdWNjZXNzIiwiZXJyb3IiLCJwcm9ncmVzcyIsIl90aGlzIiwicmVzb2x2ZSIsInJlamVjdCIsImRvbmUiLCJyZXNwb25zZSIsImV4IiwiZXJyb3JNZXNzYWdlIiwic2V0VGltZW91dCIsIkhhbmRsZSIsIm9uUmVzb2x2ZWQiLCJvblJlamVjdGVkIiwiY2FuY2VsIiwiT25GdWxsRmlsbGVkIiwicmVzdWx0IiwiUmVzb2x2ZWQiLCJmb3JFYWNoIiwiaGFuZGxlciIsIk9uUmVqZWN0ZWQiLCJSZWplY3RlZCIsIlJlc29sdmUiLCJHZXRUaGVuIiwiYmluZCIsImUiLCJwdXNoIiwiaGFzQmVlblJlc29sdmVkIiwidmFsdWUiLCJyZWFzb24iLCJ0IiwiUHJvbWlzZVNpbXVsYXRvciIsIl9zaW1WYWx1ZSIsIkNvbmZpZ3VyYXRpb24iLCJFdmVudCIsIktleSIsIkV2ZW50T2JqZWN0IiwiTG9jYXRpb24iLCJzZXRMb2NhdGlvbiIsImxhdCIsImxuZyIsImNvb3JkaW5hdGVzIiwiQ29vcmRpbmF0ZXMiLCJzZXRQb3NpdGlvbiIsInBvc2l0aW9uIiwibGF0aXR1ZGUiLCJKU09OIiwic3RyaW5naWZ5IiwibG9uZ2l0dWRlIiwiY29vcmRzIiwiU3RydWN0dXJlIiwiQ29uZmlnUHJvdmlkZXIiLCJHZXRDb25maWd1cmF0aW9ucyIsIkN1cnJlbnRFbnZpcm9ubWVudCIsIm5vZGVHZXQiLCJzdGFuZGFsb25lR2V0IiwiY29uZmlncyIsImxvY2F0aW9uIiwic2VhcmNoIiwic3Vic3RyIiwidmFycyIsInNwbGl0IiwiaSIsInBhaXIiLCJjb25maWd1cmF0aW9uSGFuZGxlciIsImdldENvbmZpZ3VyYXRpb25zIiwiR2VvUHJvdmlkZXIiLCJHZXRMb2NhdGlvbiIsIm5vZGVHZXRMb2NhdGlvbiIsInN0YW5kYWxvbmVHZXRMb2NhdGlvbiIsIm5hdmlnYXRvciIsImdlb2xvY2F0aW9uIiwiZ2V0Q3VycmVudFBvc2l0aW9uIiwiY29kZSIsIlBFUk1JU1NJT05fREVOSUVEIiwiUE9TSVRJT05fVU5BVkFJTEFCTEUiLCJUSU1FT1VUIiwiZ2VvU2VydmljZUhhbmRsZXIiLCJnZXRMb2NhdGlvbiIsIlNlcnZpY2VDbGllbnQiLCJuYW1lIiwiVmFsaWRhdGUiLCJfa2V5IiwiX25hbWUiLCJHZXQiLCJvYmplY3RUeXBlIiwidGFrZSIsInNraXAiLCJvcmRlckJ5IiwiZmlsdGVyIiwiR2V0T25lIiwiaWQiLCJQb3N0IiwiYm9keSIsIlB1dCIsIkRlbGV0ZSIsIl9fZXh0ZW5kcyIsImQiLCJiIiwiX18iLCJjb25zdHJ1Y3RvciIsInAiLCJjcmVhdGUiLCJOb2RlU2VydmljZUNsaWVudCIsIl9zdXBlciIsImtleVRva2VuIiwiY2FsbCIsInNlcnZpY2VIYW5kbGVyIiwiVHJ5VG9HZXRTZXJ2aWNlSGFuZGxlciIsIl9zZXJ2aWNlUHJveHkiLCJnZXRTZXJ2aWNlIiwiTmFtZSIsImdldE9uZSIsInBvc3QiLCJwdXQiLCJTdGFuZGFsb25lU2VydmljZUNsaWVudCIsImFwaVVybCIsIl9zZXJ2aWNlUHJlZml4IiwiX2pzb25Db250ZW50VHlwZSIsIl9yZXF1ZXN0QXN5bmMiLCJTZXRCYXNlUGF0aCIsIl9rZXlUb2tlbiIsImJhc2UiLCJfYmFzZVBhdGgiLCJyYyIsIkNyZWF0ZU1ldGhvZFJlcXVlc3QiLCJzZW5kIiwiT25YTUxIdHRwUmVxdWVzdFJlc3BvbnNlIiwiQ3JlYXRlTWV0aG9kSnNvblJlcXVlc3QiLCJpc0h0dHBTdGF0dXNWYWxpZCIsIklzSHR0cFN0YXR1c1ZhbGlkIiwib25sb2FkIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsIm9uZXJyb3IiLCJDcmVhdGVSZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJtZXRob2QiLCJ1cmwiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsIkZpbHRlclVybCIsImluZGV4T2YiLCJyZXBsYWNlIiwidG9Mb3dlckNhc2UiLCJTZXJ2aWNlUHJvdmlkZXIiLCJHZXRTZXJ2aWNlIiwiU2V0U2VydmljZUtleVRva2VuIiwiVHJhZmZpY1dvcmtlciIsInRyYWZmaWNTZXR0aW5ncyIsIl90cmFmZmljU2V0dGluZ3MiLCJvbkV2ZW50UmVjZWl2ZWQiLCJldmVudCIsInRvU3RyaW5nIiwiTm9kZVRyYWZmaWNXb3JrZXIiLCJPdXRib3VuZEV2ZW50IiwiSW5ib3VuZEV2ZW50IiwicGFyc2VkRXZlbnQiLCJwYXJzZSIsIlN0YW5kYWxvbmVUcmFmZmljV29ya2VyIiwiVHJhZmZpY01hbmFnZXIiLCJXb3JrZXIiLCJTZXRFbnZpcm9ubWVudFdvcmtlciIsIlNlbmRFdmVudCIsImV2ZW50T2JqZWN0IiwiQ3JlYXRlRXZlbnQiLCJSZXF1ZXN0Rm9jdXMiLCJzZXZlcml0eSIsIl9mb2N1c1JlcXVlc3RQYXJhbWV0ZXIiXSwibWFwcGluZ3MiOiJBQUlBLEdBQUlBLGVBQ0osU0FBV0Es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QWtCTCxHQUM3QixHQUFJbk0sR0FBTzZNLHdCQUF3QlYsSUFFM0NXLEVBQWVRLHVCQUF5QixlQUNqQ1IsSUFFWDlNLEdBQU84TSxlQUFpQkEsR0FDekI5TSxTQUFXQSIsImZpbGUiOiJhcHAtYXBwbW9kLXdhcGdlbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiAgIERlY2xhcmF0aW9uIGZpbGVcbiogICBEZWNsYXJlcyBleHRlbnNpb24gaW5qZWN0ZWQgZnJvbSBTaGVsbFxuKi9cbnZhciBFbnZpcm9ubWVudHM7XG4oZnVuY3Rpb24gKEVudmlyb25tZW50cykge1xuICAgIEVudmlyb25tZW50c1tFbnZpcm9ubWVudHNbXCJOb2RlXCJdID0gMF0gPSBcIk5vZGVcIjtcbiAgICBFbnZpcm9ubWVudHNbRW52aXJvbm1lbnRzW1wiU3RhbmRhbG9uZVwiXSA9IDFdID0gXCJTdGFuZGFsb25lXCI7XG4gICAgRW52aXJvbm1lbnRzW0Vudmlyb25tZW50c1tcIlByb3h5XCJdID0gMl0gPSBcIlByb3h5XCI7XG59KShFbnZpcm9ubWVudHMgfHwgKEVudmlyb25tZW50cyA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiTW9kZWxzL0VudW1zLnRzXCIgLz5cbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgRW52aXJvbm1lbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBFbnZpcm9ubWVudCgpIHtcbiAgICAgICAgICAgIHRoaXMuX2Vudmlyb25tZW50ID0gRW52aXJvbm1lbnRzLlN0YW5kYWxvbmU7XG4gICAgICAgICAgICBpZiAoRW52aXJvbm1lbnQuX2luc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXJyb3I6IEluc3RhbnRpYXRpb24gZmFpbGVkOiBVc2UgRW52aXJvbm1lbnQuZ2V0SW5zdGFuY2UoKSBpbnN0ZWFkIG9mIG5ldy5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLlJlc2V0RW52aXJvbm1lbnQoKTtcbiAgICAgICAgICAgIEVudmlyb25tZW50Ll9pbnN0YW5jZSA9IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVudmlyb25tZW50LnByb3RvdHlwZSwgXCJDdXJyZW50RW52aXJvbm1lbnRcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Vudmlyb25tZW50O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIEVudmlyb25tZW50LmdldEluc3RhbmNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEVudmlyb25tZW50Ll9pbnN0YW5jZTtcbiAgICAgICAgfTtcbiAgICAgICAgRW52aXJvbm1lbnQucHJvdG90eXBlLlJlc2V0RW52aXJvbm1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9lbnZpcm9ubWVudCA9IHRoaXMuU2V0RW52aXJvbm1lbnQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRW52aXJvbm1lbnQucHJvdG90eXBlLlNldEVudmlyb25tZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gSWYgd2luZG93LmV4dGVybmFsLm5vdGlmeSB0aHJvd3MgYW4gZXhjZXB0aW9uIGl0IGluZGljYXRlc1xuICAgICAgICAgICAgLy8gdGhhdCB3ZSBhcmUgbm90IGluIGEgc2hlbGwsIGkuZSBzdGFuZGFsb25lXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5leHRlcm5hbC5ub3RpZnkoRW52aXJvbm1lbnQuX3Rlc3RQYXJhbWV0ZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybiBFbnZpcm9ubWVudHMuTm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gRW52aXJvbm1lbnRzLlN0YW5kYWxvbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEVudmlyb25tZW50Ll90ZXN0UGFyYW1ldGVyID0gXCJUZXN0XCI7XG4gICAgICAgIEVudmlyb25tZW50Ll9pbnN0YW5jZSA9IG5ldyBFbnZpcm9ubWVudCgpO1xuICAgICAgICByZXR1cm4gRW52aXJvbm1lbnQ7XG4gICAgfSgpKTtcbiAgICBXYXBDb20uRW52aXJvbm1lbnQgPSBFbnZpcm9ubWVudDtcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0Jztcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0Jztcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0Jztcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0Jztcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUGF0aCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFBhdGgoKSB7XG4gICAgICAgIH1cbiAgICAgICAgUGF0aC5Kb2luT25TZXAgPSBmdW5jdGlvbiAoc2VwZXJhdG9yKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFyZ3Muam9pbihzZXBlcmF0b3IpO1xuICAgICAgICB9O1xuICAgICAgICBQYXRoLkpvaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMF0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFyZ3Muam9pbignJyk7XG4gICAgICAgIH07XG4gICAgICAgIFBhdGguUXVlcnkgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJz8nO1xuICAgICAgICAgICAgdmFyIGFyZ2NvdW50ID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhcmdzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFyZ3MuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJnY291bnQrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkgKz0gJyYnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5ICs9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KGFyZ3Nba2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUGF0aDtcbiAgICB9KCkpO1xuICAgIFdhcENvbS5QYXRoID0gUGF0aDtcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJQYXRoLnRzXCIgLz5cbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgUHJvbWlzZVN0YXR1cztcbiAgICAoZnVuY3Rpb24gKFByb21pc2VTdGF0dXMpIHtcbiAgICAgICAgUHJvbWlzZVN0YXR1c1tQcm9taXNlU3RhdHVzW1wiUGVuZGluZ1wiXSA9IDBdID0gXCJQZW5kaW5nXCI7XG4gICAgICAgIFByb21pc2VTdGF0dXNbUHJvbWlzZVN0YXR1c1tcIlJlc29sdmVkXCJdID0gMV0gPSBcIlJlc29sdmVkXCI7XG4gICAgICAgIFByb21pc2VTdGF0dXNbUHJvbWlzZVN0YXR1c1tcIlJlamVjdGVkXCJdID0gMl0gPSBcIlJlamVjdGVkXCI7XG4gICAgfSkoUHJvbWlzZVN0YXR1cyB8fCAoUHJvbWlzZVN0YXR1cyA9IHt9KSk7XG4gICAgdmFyIFByb21pc2VBZGFwdGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gUHJvbWlzZUFkYXB0ZXIoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUHJvbWlzZVN0YXR1cy5QZW5kaW5nO1xuICAgICAgICAgICAgdGhpcy5fdmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuRG9SZXNvbHZlKGNhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlQWRhcHRlci5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChzdWNjZXNzLCBlcnJvciwgcHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAvLyBBZGRpbmcgYSBuZXcgcHJvbWlzZSBJbXBsIGFuZCBjb25uZWN0IHRoZSBsYXN0IG9uZSB3aXRoIGRvbmVcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZUFkYXB0ZXIoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kb25lKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN1Y2Nlc3MgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoc3VjY2VzcyhyZXNwb25zZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoZXJyb3IoZXJyb3JNZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVqZWN0KGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBZGFwdGVyLnByb3RvdHlwZS5kb25lID0gZnVuY3Rpb24gKHN1Y2Nlc3MsIGVycm9yLCBwcm9ncmVzcykge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLkhhbmRsZSh7XG4gICAgICAgICAgICAgICAgICAgIG9uUmVzb2x2ZWQ6IHN1Y2Nlc3MsXG4gICAgICAgICAgICAgICAgICAgIG9uUmVqZWN0ZWQ6IGVycm9yXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBQcm9taXNlQWRhcHRlci5wcm90b3R5cGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQWRhcHRlci5wcm90b3R5cGUuT25GdWxsRmlsbGVkID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUHJvbWlzZVN0YXR1cy5SZXNvbHZlZDtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gcmVzdWx0O1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMuZm9yRWFjaChmdW5jdGlvbiAoaGFuZGxlcikge1xuICAgICAgICAgICAgICAgIF90aGlzLkhhbmRsZShoYW5kbGVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMgPSBudWxsO1xuICAgICAgICB9O1xuICAgICAgICBQcm9taXNlQWRhcHRlci5wcm90b3R5cGUuT25SZWplY3RlZCA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gUHJvbWlzZVN0YXR1cy5SZWplY3RlZDtcbiAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gZXJyb3I7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuSGFuZGxlKGhhbmRsZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVycyA9IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBZGFwdGVyLnByb3RvdHlwZS5SZXNvbHZlID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgdGhlbiA9IHRoaXMuR2V0VGhlbihyZXN1bHQpO1xuICAgICAgICAgICAgICAgIGlmICh0aGVuKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuRG9SZXNvbHZlKHRoZW4uYmluZChyZXN1bHQpKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLk9uRnVsbEZpbGxlZChyZXN1bHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLk9uUmVqZWN0ZWQoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBZGFwdGVyLnByb3RvdHlwZS5IYW5kbGUgPSBmdW5jdGlvbiAoaGFuZGxlcikge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBQcm9taXNlU3RhdHVzLlBlbmRpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKGhhbmRsZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBQcm9taXNlU3RhdHVzLlJlc29sdmVkICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBoYW5kbGVyLm9uUmVzb2x2ZWQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5vblJlc29sdmVkKHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBQcm9taXNlU3RhdHVzLlJlamVjdGVkICYmXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBoYW5kbGVyLm9uUmVqZWN0ZWQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlci5vblJlamVjdGVkKHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBZGFwdGVyLnByb3RvdHlwZS5Eb1Jlc29sdmUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgaGFzQmVlblJlc29sdmVkID0gZmFsc2U7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzQmVlblJlc29sdmVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBoYXNCZWVuUmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5SZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNCZWVuUmVzb2x2ZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGhhc0JlZW5SZXNvbHZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLk9uUmVqZWN0ZWQocmVhc29uKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIGlmIChoYXNCZWVuUmVzb2x2ZWQpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBoYXNCZWVuUmVzb2x2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuT25SZWplY3RlZChleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VBZGFwdGVyLnByb3RvdHlwZS5HZXRUaGVuID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdCA9IHR5cGVvZiB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAmJiAodCA9PT0gJ29iamVjdCcgfHwgdCA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhlbiA9IHZhbHVlLnRoZW47XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGVuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUHJvbWlzZUFkYXB0ZXI7XG4gICAgfSgpKTtcbiAgICBXYXBDb20uUHJvbWlzZUFkYXB0ZXIgPSBQcm9taXNlQWRhcHRlcjtcbiAgICB2YXIgUHJvbWlzZVNpbXVsYXRvciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFByb21pc2VTaW11bGF0b3IoX3NpbVZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9zaW1WYWx1ZSA9IF9zaW1WYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBQcm9taXNlU2ltdWxhdG9yLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24gKHN1Y2Nlc3MsIGVycm9yLCBwcm9ncmVzcykge1xuICAgICAgICAgICAgc3VjY2Vzcyh0aGlzLl9zaW1WYWx1ZSk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgUHJvbWlzZVNpbXVsYXRvci5wcm90b3R5cGUuZG9uZSA9IGZ1bmN0aW9uIChzdWNjZXNzLCBlcnJvciwgcHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgIHN1Y2Nlc3ModGhpcy5fc2ltVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIFByb21pc2VTaW11bGF0b3IucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFByb21pc2VTaW11bGF0b3I7XG4gICAgfSgpKTtcbiAgICBXYXBDb20uUHJvbWlzZVNpbXVsYXRvciA9IFByb21pc2VTaW11bGF0b3I7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG52YXIgV2FwQ29tO1xuKGZ1bmN0aW9uIChXYXBDb20pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIENvbmZpZ3VyYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDb25maWd1cmF0aW9uKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMua2V5ID0ga2V5O1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBDb25maWd1cmF0aW9uO1xuICAgIH0oKSk7XG4gICAgV2FwQ29tLkNvbmZpZ3VyYXRpb24gPSBDb25maWd1cmF0aW9uO1xufSkoV2FwQ29tIHx8IChXYXBDb20gPSB7fSkpO1xudmFyIFdhcENvbTtcbihmdW5jdGlvbiAoV2FwQ29tKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIC8qKlxuICAgICAqIEV2ZW50XG4gICAgICovXG4gICAgdmFyIEV2ZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gRXZlbnQoa2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5LZXkgPSBrZXk7XG4gICAgICAgICAgICB0aGlzLkV2ZW50T2JqZWN0ID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEV2ZW50O1xuICAgIH0oKSk7XG4gICAgV2FwQ29tLkV2ZW50ID0gRXZlbnQ7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG52YXIgV2FwQ29tO1xuKGZ1bmN0aW9uIChXYXBDb20pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIExvY2F0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTG9jYXRpb24oKSB7XG4gICAgICAgIH1cbiAgICAgICAgTG9jYXRpb24ucHJvdG90eXBlLnNldExvY2F0aW9uID0gZnVuY3Rpb24gKGxhdCwgbG5nKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY29vcmRpbmF0ZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvb3JkaW5hdGVzID0gbmV3IENvb3JkaW5hdGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNvb3JkaW5hdGVzLnNldExvY2F0aW9uKGxhdCwgbG5nKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9jYXRpb24ucHJvdG90eXBlLnNldFBvc2l0aW9uID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY29vcmRpbmF0ZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvb3JkaW5hdGVzID0gbmV3IENvb3JkaW5hdGVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNvb3JkaW5hdGVzLnNldFBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIExvY2F0aW9uO1xuICAgIH0oKSk7XG4gICAgV2FwQ29tLkxvY2F0aW9uID0gTG9jYXRpb247XG4gICAgdmFyIENvb3JkaW5hdGVzID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQ29vcmRpbmF0ZXMoKSB7XG4gICAgICAgIH1cbiAgICAgICAgQ29vcmRpbmF0ZXMucHJvdG90eXBlLnNldExvY2F0aW9uID0gZnVuY3Rpb24gKGxhdCwgbG5nKSB7XG4gICAgICAgICAgICB0aGlzLmxhdGl0dWRlID0gKGxhdCkgPyBKU09OLnN0cmluZ2lmeShsYXQpIDogXCIwXCI7XG4gICAgICAgICAgICB0aGlzLmxvbmdpdHVkZSA9IChsbmcpID8gSlNPTi5zdHJpbmdpZnkobG5nKSA6IFwiMFwiO1xuICAgICAgICB9O1xuICAgICAgICBDb29yZGluYXRlcy5wcm90b3R5cGUuc2V0UG9zaXRpb24gPSBmdW5jdGlvbiAocG9zaXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMubGF0aXR1ZGUgPSBcIjBcIjtcbiAgICAgICAgICAgIHRoaXMubG9uZ2l0dWRlID0gXCIwXCI7XG4gICAgICAgICAgICBpZiAocG9zaXRpb24gJiYgcG9zaXRpb24uY29vcmRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sYXRpdHVkZSA9IHBvc2l0aW9uLmNvb3Jkcy5sYXRpdHVkZTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvbmdpdHVkZSA9IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDb29yZGluYXRlcztcbiAgICB9KCkpO1xuICAgIFdhcENvbS5Db29yZGluYXRlcyA9IENvb3JkaW5hdGVzO1xuICAgIHZhciBTdHJ1Y3R1cmUgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBTdHJ1Y3R1cmUoKSB7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFN0cnVjdHVyZTtcbiAgICB9KCkpO1xuICAgIFdhcENvbS5TdHJ1Y3R1cmUgPSBTdHJ1Y3R1cmU7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vRW52aXJvbm1lbnQudHNcIiAvPlxudmFyIFdhcENvbTtcbihmdW5jdGlvbiAoV2FwQ29tKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBDb25maWdQcm92aWRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIENvbmZpZ1Byb3ZpZGVyKCkge1xuICAgICAgICB9XG4gICAgICAgIENvbmZpZ1Byb3ZpZGVyLkdldENvbmZpZ3VyYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIChXYXBDb20uRW52aXJvbm1lbnQuZ2V0SW5zdGFuY2UoKS5DdXJyZW50RW52aXJvbm1lbnQgPT0gRW52aXJvbm1lbnRzLk5vZGUpID9cbiAgICAgICAgICAgICAgICBDb25maWdQcm92aWRlci5ub2RlR2V0KCkgOiBDb25maWdQcm92aWRlci5zdGFuZGFsb25lR2V0KCk7XG4gICAgICAgIH07XG4gICAgICAgIENvbmZpZ1Byb3ZpZGVyLnN0YW5kYWxvbmVHZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdhcENvbS5Qcm9taXNlQWRhcHRlcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ3MgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgcXVlcnkgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFycyA9IHF1ZXJ5LnNwbGl0KFwiJlwiKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhaXIgPSB2YXJzW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlncy5wdXNoKG5ldyBXYXBDb20uQ29uZmlndXJhdGlvbihwYWlyWzBdLCBwYWlyWzFdKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlc29sdmUoY29uZmlncyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29uZmlnUHJvdmlkZXIubm9kZUdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2FwQ29tLlByb21pc2VBZGFwdGVyKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWNvbmZpZ3VyYXRpb25IYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gZ2V0IGNvbmZpZ3VyYXRpb25zLCBkdWUgdG8gY29uZmlndXJhdGlvbkhhbmRsZXIgaXMgbnVsbC5cIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZ3MgPSBjb25maWd1cmF0aW9uSGFuZGxlci5nZXRDb25maWd1cmF0aW9ucygpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvbmZpZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ29uZmlnUHJvdmlkZXI7XG4gICAgfSgpKTtcbiAgICBXYXBDb20uQ29uZmlnUHJvdmlkZXIgPSBDb25maWdQcm92aWRlcjtcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9FbnZpcm9ubWVudC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vTW9kZWxzL0xvY2F0aW9uLnRzXCIgLz5cbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgR2VvUHJvdmlkZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBHZW9Qcm92aWRlcigpIHtcbiAgICAgICAgfVxuICAgICAgICBHZW9Qcm92aWRlci5HZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChsYXQsIGxuZykge1xuICAgICAgICAgICAgaWYgKGxhdCA9PT0gdm9pZCAwKSB7IGxhdCA9IDE1LjY0MTI2OyB9XG4gICAgICAgICAgICBpZiAobG5nID09PSB2b2lkIDApIHsgbG5nID0gNTguNDE2NTk7IH1cbiAgICAgICAgICAgIHJldHVybiAoV2FwQ29tLkVudmlyb25tZW50LmdldEluc3RhbmNlKCkuQ3VycmVudEVudmlyb25tZW50ID09IEVudmlyb25tZW50cy5Ob2RlKSA/XG4gICAgICAgICAgICAgICAgR2VvUHJvdmlkZXIubm9kZUdldExvY2F0aW9uKGxhdCwgbG5nKSA6IEdlb1Byb3ZpZGVyLnN0YW5kYWxvbmVHZXRMb2NhdGlvbihsYXQsIGxuZyk7XG4gICAgICAgIH07XG4gICAgICAgIEdlb1Byb3ZpZGVyLnN0YW5kYWxvbmVHZXRMb2NhdGlvbiA9IGZ1bmN0aW9uIChsYXQsIGxuZykge1xuICAgICAgICAgICAgaWYgKGxhdCA9PT0gdm9pZCAwKSB7IGxhdCA9IDE1LjY0MTI2OyB9XG4gICAgICAgICAgICBpZiAobG5nID09PSB2b2lkIDApIHsgbG5nID0gNTguNDE2NTk7IH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgV2FwQ29tLlByb21pc2VBZGFwdGVyKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBuZXcgV2FwQ29tLkxvY2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24uc2V0TG9jYXRpb24obGF0LCBsbmcpO1xuICAgICAgICAgICAgICAgIC8vIEluIENocm9tZSBmb3IgaW5zdGFjZSwgb25seSBzdXBwb3J0IGxvY2F0aW9uIHdpdGggaHR0cHNcbiAgICAgICAgICAgICAgICAvLyBodHRwOi8vY2FuaXVzZS5jb20vI3NlYXJjaD1sb2NhdGlvblxuICAgICAgICAgICAgICAgIGlmIChuYXZpZ2F0b3IgJiYgbmF2aWdhdG9yLmdlb2xvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIG5hdmlnYXRvclxuICAgICAgICAgICAgICAgICAgICAgICAgLmdlb2xvY2F0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAuZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uIChwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uc2V0UG9zaXRpb24ocG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlcnJvci5jb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBlcnJvci5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShsb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBlcnJvci5QT1NJVElPTl9VTkFWQUlMQUJMRTpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTG9jYXRpb24gaW5mb3JtYXRpb24gaXMgdW5hdmFpbGFibGUuXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgZXJyb3IuVElNRU9VVDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiVGhlIHJlcXVlc3QgdG8gZ2V0IHVzZXIgbG9jYXRpb24gdGltZWQgb3V0LlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJBbiB1bmtub3duIGVycm9yIG9jY3VycmVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgR2VvUHJvdmlkZXIubm9kZUdldExvY2F0aW9uID0gZnVuY3Rpb24gKGxhdCwgbG5nKSB7XG4gICAgICAgICAgICBpZiAobGF0ID09PSB2b2lkIDApIHsgbGF0ID0gMTUuNjQxMjY7IH1cbiAgICAgICAgICAgIGlmIChsbmcgPT09IHZvaWQgMCkgeyBsbmcgPSA1OC40MTY1OTsgfVxuICAgICAgICAgICAgaWYgKCFnZW9TZXJ2aWNlSGFuZGxlcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBnZXQgbG9jYXRpb24sIGR1ZSB0byBnZW9TZXJ2aWNlSGFuZGxlciBpcyBudWxsLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgV2FwQ29tLlByb21pc2VBZGFwdGVyKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbG9jYXRpb24gPSBnZW9TZXJ2aWNlSGFuZGxlci5nZXRMb2NhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEdlb1Byb3ZpZGVyO1xuICAgIH0oKSk7XG4gICAgV2FwQ29tLkdlb1Byb3ZpZGVyID0gR2VvUHJvdmlkZXI7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vQ29udHJhY3QvSVNlcnZpY2VDbGllbnQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL0hlbHBlcnMvUHJvbWlzZUltcGxlbWVudGF0aW9ucy50c1wiIC8+XG52YXIgV2FwQ29tO1xuKGZ1bmN0aW9uIChXYXBDb20pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIFNlcnZpY2VDbGllbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBTZXJ2aWNlQ2xpZW50KG5hbWUsIGtleSkge1xuICAgICAgICAgICAgdGhpcy5WYWxpZGF0ZShuYW1lLCBrZXkpO1xuICAgICAgICAgICAgdGhpcy5fa2V5ID0ga2V5O1xuICAgICAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNlcnZpY2VDbGllbnQucHJvdG90eXBlLCBcIktleVwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fa2V5O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZSwgXCJOYW1lXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIFNlcnZpY2VDbGllbnQucHJvdG90eXBlLkdldCA9IGZ1bmN0aW9uIChvYmplY3RUeXBlLCB0YWtlLCBza2lwLCBvcmRlckJ5LCBmaWx0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2FwQ29tLlByb21pc2VTaW11bGF0b3IoXCJHZXQgc3VjY2Vzc1wiKTtcbiAgICAgICAgfTtcbiAgICAgICAgU2VydmljZUNsaWVudC5wcm90b3R5cGUuR2V0T25lID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdhcENvbS5Qcm9taXNlU2ltdWxhdG9yKFwiR2V0T25lIHN1Y2Nlc3NcIik7XG4gICAgICAgIH07XG4gICAgICAgIFNlcnZpY2VDbGllbnQucHJvdG90eXBlLlBvc3QgPSBmdW5jdGlvbiAob2JqZWN0VHlwZSwgYm9keSkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXYXBDb20uUHJvbWlzZVNpbXVsYXRvcihcIlBvc3Qgc3VjY2Vzc1wiKTtcbiAgICAgICAgfTtcbiAgICAgICAgU2VydmljZUNsaWVudC5wcm90b3R5cGUuUHV0ID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGlkLCBib2R5KSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdhcENvbS5Qcm9taXNlU2ltdWxhdG9yKFwiUHV0IHN1Y2Nlc3NcIik7XG4gICAgICAgIH07XG4gICAgICAgIFNlcnZpY2VDbGllbnQucHJvdG90eXBlLkRlbGV0ZSA9IGZ1bmN0aW9uIChvYmplY3RUeXBlLCBpZCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXYXBDb20uUHJvbWlzZVNpbXVsYXRvcihcInRydWVcIik7XG4gICAgICAgIH07XG4gICAgICAgIFNlcnZpY2VDbGllbnQucHJvdG90eXBlLlZhbGlkYXRlID0gZnVuY3Rpb24gKG5hbWUsIGtleSkge1xuICAgICAgICAgICAgaWYgKCFuYW1lIHx8IG5hbWUgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgbmFtZSwgcGxlYXNlIGZpbGwgb3V0IGNvcnJlY3QgbmFtZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgha2V5IHx8IGtleSA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBrZXksIHBsZWFzZSBmaWxsIG91dCBjb3JyZWN0IGtleVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFNlcnZpY2VDbGllbnQ7XG4gICAgfSgpKTtcbiAgICBXYXBDb20uU2VydmljZUNsaWVudCA9IFNlcnZpY2VDbGllbnQ7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vQ29udHJhY3QvSVNlcnZpY2VDbGllbnQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlNlcnZpY2VDbGllbnQudHNcIiAvPlxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbn07XG52YXIgV2FwQ29tO1xuKGZ1bmN0aW9uIChXYXBDb20pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIE5vZGVTZXJ2aWNlQ2xpZW50ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKE5vZGVTZXJ2aWNlQ2xpZW50LCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBOb2RlU2VydmljZUNsaWVudChuYW1lLCBrZXksIGtleVRva2VuKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBuYW1lLCBrZXkpO1xuICAgICAgICAgICAgdmFyIHNlcnZpY2VIYW5kbGVyID0gdGhpcy5UcnlUb0dldFNlcnZpY2VIYW5kbGVyKCk7XG4gICAgICAgICAgICB0aGlzLl9zZXJ2aWNlUHJveHkgPSBzZXJ2aWNlSGFuZGxlci5nZXRTZXJ2aWNlKHRoaXMuTmFtZSwgdGhpcy5LZXkpO1xuICAgICAgICB9XG4gICAgICAgIE5vZGVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5HZXQgPSBmdW5jdGlvbiAob2JqZWN0VHlwZSwgdGFrZSwgc2tpcCwgb3JkZXJCeSwgZmlsdGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZVByb3h5LmdldChvYmplY3RUeXBlLCB0YWtlLCBza2lwLCBvcmRlckJ5LCBmaWx0ZXIpO1xuICAgICAgICB9O1xuICAgICAgICBOb2RlU2VydmljZUNsaWVudC5wcm90b3R5cGUuR2V0T25lID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZVByb3h5LmdldE9uZShvYmplY3RUeXBlLCBpZCk7XG4gICAgICAgIH07XG4gICAgICAgIE5vZGVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5Qb3N0ID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGJvZHkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZXJ2aWNlUHJveHkucG9zdChvYmplY3RUeXBlLCBib2R5KTtcbiAgICAgICAgfTtcbiAgICAgICAgTm9kZVNlcnZpY2VDbGllbnQucHJvdG90eXBlLlB1dCA9IGZ1bmN0aW9uIChvYmplY3RUeXBlLCBpZCwgYm9keSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlcnZpY2VQcm94eS5wdXQob2JqZWN0VHlwZSwgaWQsIGJvZHkpO1xuICAgICAgICB9O1xuICAgICAgICBOb2RlU2VydmljZUNsaWVudC5wcm90b3R5cGUuRGVsZXRlID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VydmljZVByb3h5LmRlbGV0ZShvYmplY3RUeXBlLCBpZCk7XG4gICAgICAgIH07XG4gICAgICAgIE5vZGVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5UcnlUb0dldFNlcnZpY2VIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCFzZXJ2aWNlSGFuZGxlcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBjcmVhdGUgU2VydmljZUNsaWVudCwgZHVlIHRvIHNlcnZpY2VoYW5kbGVyIGlzIG51bGxcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gc2VydmljZUhhbmRsZXI7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBOb2RlU2VydmljZUNsaWVudDtcbiAgICB9KFdhcENvbS5TZXJ2aWNlQ2xpZW50KSk7XG4gICAgV2FwQ29tLk5vZGVTZXJ2aWNlQ2xpZW50ID0gTm9kZVNlcnZpY2VDbGllbnQ7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vQ29udHJhY3QvSVNlcnZpY2VDbGllbnQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL0hlbHBlcnMvUGF0aC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vSGVscGVycy9Qcm9taXNlSW1wbGVtZW50YXRpb25zLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJTZXJ2aWNlQ2xpZW50LnRzXCIgLz5cbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFN0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50KG5hbWUsIGtleSwgYXBpVXJsLCBrZXlUb2tlbikge1xuICAgICAgICAgICAgaWYgKGFwaVVybCA9PT0gdm9pZCAwKSB7IGFwaVVybCA9IFwiXCI7IH1cbiAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIG5hbWUsIGtleSk7XG4gICAgICAgICAgICB0aGlzLl9zZXJ2aWNlUHJlZml4ID0gXCJzZXJ2aWNlc1wiO1xuICAgICAgICAgICAgdGhpcy5fanNvbkNvbnRlbnRUeXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFzeW5jID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuU2V0QmFzZVBhdGgoYXBpVXJsKTtcbiAgICAgICAgICAgIHRoaXMuX2tleVRva2VuID0ga2V5VG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQucHJvdG90eXBlLkdldCA9IGZ1bmN0aW9uIChvYmplY3RUeXBlLCB0YWtlLCBza2lwLCBvcmRlckJ5LCBmaWx0ZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgYmFzZSA9IFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIHRoaXMuX2Jhc2VQYXRoLCAndHlwZXMnLCBvYmplY3RUeXBlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2FwQ29tLlByb21pc2VBZGFwdGVyKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmMgPSBfdGhpcy5DcmVhdGVNZXRob2RSZXF1ZXN0KCdHRVQnLCBXYXBDb20uUGF0aC5Kb2luKGJhc2UsIFdhcENvbS5QYXRoLlF1ZXJ5KHtcbiAgICAgICAgICAgICAgICAgICAgJ3Rha2UnOiB0YWtlLFxuICAgICAgICAgICAgICAgICAgICAnc2tpcCc6IHNraXAsXG4gICAgICAgICAgICAgICAgICAgICdvcmRlckJ5Jzogb3JkZXJCeSxcbiAgICAgICAgICAgICAgICAgICAgJ2ZpbHRlcic6IGZpbHRlclxuICAgICAgICAgICAgICAgIH0pKSk7XG4gICAgICAgICAgICAgICAgcmMuc2VuZCgpO1xuICAgICAgICAgICAgICAgIF90aGlzLk9uWE1MSHR0cFJlcXVlc3RSZXNwb25zZShyYywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBTdGFuZGFsb25lU2VydmljZUNsaWVudC5wcm90b3R5cGUuR2V0T25lID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGlkKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXYXBDb20uUHJvbWlzZUFkYXB0ZXIoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciByYyA9IF90aGlzLkNyZWF0ZU1ldGhvZFJlcXVlc3QoJ0dFVCcsIFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIF90aGlzLl9iYXNlUGF0aCwgJ3R5cGVzJywgb2JqZWN0VHlwZSwgaWQpKTtcbiAgICAgICAgICAgICAgICByYy5zZW5kKCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuT25YTUxIdHRwUmVxdWVzdFJlc3BvbnNlKHJjLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFN0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5Qb3N0ID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGJvZHkpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgYmFzZSA9IFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIHRoaXMuX2Jhc2VQYXRoLCAndHlwZXMnLCBvYmplY3RUeXBlKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgV2FwQ29tLlByb21pc2VBZGFwdGVyKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmMgPSBfdGhpcy5DcmVhdGVNZXRob2RKc29uUmVxdWVzdCgnUE9TVCcsIGJhc2UpO1xuICAgICAgICAgICAgICAgIHJjLnNlbmQoYm9keSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuT25YTUxIdHRwUmVxdWVzdFJlc3BvbnNlKHJjLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFN0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5QdXQgPSBmdW5jdGlvbiAob2JqZWN0VHlwZSwgaWQsIGJvZHkpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFdhcENvbS5Qcm9taXNlQWRhcHRlcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHJjID0gX3RoaXMuQ3JlYXRlTWV0aG9kSnNvblJlcXVlc3QoJ1BVVCcsIFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIF90aGlzLl9iYXNlUGF0aCwgJ3R5cGVzJywgb2JqZWN0VHlwZSwgaWQpKTtcbiAgICAgICAgICAgICAgICByYy5zZW5kKGJvZHkpO1xuICAgICAgICAgICAgICAgIF90aGlzLk9uWE1MSHR0cFJlcXVlc3RSZXNwb25zZShyYywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBTdGFuZGFsb25lU2VydmljZUNsaWVudC5wcm90b3R5cGUuRGVsZXRlID0gZnVuY3Rpb24gKG9iamVjdFR5cGUsIGlkKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBXYXBDb20uUHJvbWlzZUFkYXB0ZXIoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIHZhciByYyA9IF90aGlzLkNyZWF0ZU1ldGhvZFJlcXVlc3QoJ0RFTEVURScsIFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIF90aGlzLl9iYXNlUGF0aCwgJ3R5cGVzJywgb2JqZWN0VHlwZSwgaWQpKTtcbiAgICAgICAgICAgICAgICByYy5zZW5kKCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuT25YTUxIdHRwUmVxdWVzdFJlc3BvbnNlKHJjLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIFN0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5PblhNTEh0dHBSZXF1ZXN0UmVzcG9uc2UgPSBmdW5jdGlvbiAocmMsIHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGlzSHR0cFN0YXR1c1ZhbGlkID0gdGhpcy5Jc0h0dHBTdGF0dXNWYWxpZDtcbiAgICAgICAgICAgIHJjLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNIdHRwU3RhdHVzVmFsaWQodGhpcy5zdGF0dXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmMub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZWplY3QodGhpcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIFN0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50LnByb3RvdHlwZS5Jc0h0dHBTdGF0dXNWYWxpZCA9IGZ1bmN0aW9uIChzdGF0dXMpIHtcbiAgICAgICAgICAgIHJldHVybiAoc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDApO1xuICAgICAgICB9O1xuICAgICAgICBTdGFuZGFsb25lU2VydmljZUNsaWVudC5wcm90b3R5cGUuQ3JlYXRlUmVxdWVzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgfTtcbiAgICAgICAgU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQucHJvdG90eXBlLkNyZWF0ZU1ldGhvZFJlcXVlc3QgPSBmdW5jdGlvbiAobWV0aG9kLCB1cmwpIHtcbiAgICAgICAgICAgIHZhciByYyA9IHRoaXMuQ3JlYXRlUmVxdWVzdCgpO1xuICAgICAgICAgICAgcmMub3BlbihtZXRob2QsIHVybCwgdGhpcy5fcmVxdWVzdEFzeW5jKTtcbiAgICAgICAgICAgIHJjLnNldFJlcXVlc3RIZWFkZXIoXCJYLUtleVwiLCB0aGlzLktleSk7XG4gICAgICAgICAgICByYy5zZXRSZXF1ZXN0SGVhZGVyKFwiS2V5LVRva2VuXCIsIHRoaXMuX2tleVRva2VuKTtcbiAgICAgICAgICAgIHJldHVybiByYztcbiAgICAgICAgfTtcbiAgICAgICAgU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQucHJvdG90eXBlLkNyZWF0ZU1ldGhvZEpzb25SZXF1ZXN0ID0gZnVuY3Rpb24gKG1ldGhvZCwgdXJsKSB7XG4gICAgICAgICAgICB2YXIgcmMgPSB0aGlzLkNyZWF0ZU1ldGhvZFJlcXVlc3QobWV0aG9kLCB1cmwpO1xuICAgICAgICAgICAgcmMuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC10eXBlJywgdGhpcy5fanNvbkNvbnRlbnRUeXBlKTtcbiAgICAgICAgICAgIHJldHVybiByYztcbiAgICAgICAgfTtcbiAgICAgICAgU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQucHJvdG90eXBlLlNldEJhc2VQYXRoID0gZnVuY3Rpb24gKHVybCkge1xuICAgICAgICAgICAgaWYgKHVybCkge1xuICAgICAgICAgICAgICAgIHVybCA9IHRoaXMuRmlsdGVyVXJsKHVybCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmFzZVBhdGggPSAodXJsLmluZGV4T2YodGhpcy5fc2VydmljZVByZWZpeCkgPT09IC0xKSA/IFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIHVybCwgdGhpcy5fc2VydmljZVByZWZpeCwgdGhpcy5OYW1lKSA6IFdhcENvbS5QYXRoLkpvaW5PblNlcCgnLycsIHVybCwgdGhpcy5OYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQucHJvdG90eXBlLkZpbHRlclVybCA9IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmwucmVwbGFjZSgvXFwvJC8sICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU3RhbmRhbG9uZVNlcnZpY2VDbGllbnQ7XG4gICAgfShXYXBDb20uU2VydmljZUNsaWVudCkpO1xuICAgIFdhcENvbS5TdGFuZGFsb25lU2VydmljZUNsaWVudCA9IFN0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50O1xufSkoV2FwQ29tIHx8IChXYXBDb20gPSB7fSkpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL0Vudmlyb25tZW50LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9Db250cmFjdC9JU2VydmljZUNsaWVudC50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiU2VydmljZUNsaWVudHMvTm9kZVNlcnZpY2VDbGllbnQudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlNlcnZpY2VDbGllbnRzL1N0YW5kYWxvbmVTZXJ2aWNlQ2xpZW50LnRzXCIgLz5cbnZhciBXYXBDb207XG4oZnVuY3Rpb24gKFdhcENvbSkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgU2VydmljZVByb3ZpZGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gU2VydmljZVByb3ZpZGVyKCkge1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgYSBTZXJ2aWNlXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHNlcnZpY2UuXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgLSBUaGUga2V5IGZvciB0aGUgc2VydmljZS5cbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGFwaVVybCAtIFRoZSBhcGlVcmwgZm9yIHN0YW5kYWxvbmUgc2VydmljZS5cbiAgICAgICAgICovXG4gICAgICAgIFNlcnZpY2VQcm92aWRlci5HZXRTZXJ2aWNlID0gZnVuY3Rpb24gKG5hbWUsIGtleSwgYXBpVXJsKSB7XG4gICAgICAgICAgICBpZiAoYXBpVXJsID09PSB2b2lkIDApIHsgYXBpVXJsID0gbnVsbDsgfVxuICAgICAgICAgICAgaWYgKHRoaXMua2V5VG9rZW4gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMua2V5VG9rZW4gPSBcIlwiOyAvLyB0cnkgZ2V0IGZyb20gbG9jYWwgc3RvcmFnZTogbXMtYXBwZGF0YTovLy9sb2NhbC9rZXlUb2tlbi5qd3QgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gKFdhcENvbS5FbnZpcm9ubWVudC5nZXRJbnN0YW5jZSgpLkN1cnJlbnRFbnZpcm9ubWVudCA9PSBFbnZpcm9ubWVudHMuTm9kZSkgP1xuICAgICAgICAgICAgICAgIG5ldyBXYXBDb20uTm9kZVNlcnZpY2VDbGllbnQobmFtZSwga2V5LCB0aGlzLmtleVRva2VuKSA6XG4gICAgICAgICAgICAgICAgbmV3IFdhcENvbS5TdGFuZGFsb25lU2VydmljZUNsaWVudChuYW1lLCBrZXksIGFwaVVybCwgdGhpcy5rZXlUb2tlbik7XG4gICAgICAgIH07XG4gICAgICAgIFNlcnZpY2VQcm92aWRlci5TZXRTZXJ2aWNlS2V5VG9rZW4gPSBmdW5jdGlvbiAoa2V5VG9rZW4pIHtcbiAgICAgICAgICAgIHRoaXMua2V5VG9rZW4gPSBrZXlUb2tlbjtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFNlcnZpY2VQcm92aWRlcjtcbiAgICB9KCkpO1xuICAgIFdhcENvbS5TZXJ2aWNlUHJvdmlkZXIgPSBTZXJ2aWNlUHJvdmlkZXI7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vQ29udHJhY3QvSVRyYWZmaWNXb3JrZXIudHNcIiAvPlxudmFyIFdhcENvbTtcbihmdW5jdGlvbiAoV2FwQ29tKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBUcmFmZmljV29ya2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVHJhZmZpY1dvcmtlcih0cmFmZmljU2V0dGluZ3MpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYWZmaWNTZXR0aW5ncyA9IHRyYWZmaWNTZXR0aW5ncztcbiAgICAgICAgfVxuICAgICAgICBUcmFmZmljV29ya2VyLnByb3RvdHlwZS5vbkV2ZW50UmVjZWl2ZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90cmFmZmljU2V0dGluZ3Mub25FdmVudFJlY2VpdmVkICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0aGlzLl90cmFmZmljU2V0dGluZ3Mub25FdmVudFJlY2VpdmVkKSA9PT0gXCJbb2JqZWN0IEZ1bmN0aW9uXVwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhZmZpY1NldHRpbmdzLm9uRXZlbnRSZWNlaXZlZC5jYWxsKHRoaXMsIGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFRyYWZmaWNXb3JrZXI7XG4gICAgfSgpKTtcbiAgICBXYXBDb20uVHJhZmZpY1dvcmtlciA9IFRyYWZmaWNXb3JrZXI7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi4vLi4vQ29udHJhY3QvSVRyYWZmaWNXb3JrZXIudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlRyYWZmaWN3b3JrZXIudHNcIiAvPlxudmFyIFdhcENvbTtcbihmdW5jdGlvbiAoV2FwQ29tKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBOb2RlVHJhZmZpY1dvcmtlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhOb2RlVHJhZmZpY1dvcmtlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gTm9kZVRyYWZmaWNXb3JrZXIodHJhZmZpY1NldHRpbmdzKSB7XG4gICAgICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCB0cmFmZmljU2V0dGluZ3MpO1xuICAgICAgICAgICAgd2luZG93Lk91dGJvdW5kRXZlbnQgPSB0aGlzLk91dGJvdW5kRXZlbnQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHdpbmRvdy5JbmJvdW5kRXZlbnQgPSB0aGlzLkluYm91bmRFdmVudC5iaW5kKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIE5vZGVUcmFmZmljV29ya2VyLnByb3RvdHlwZS5PdXRib3VuZEV2ZW50ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICB3aW5kb3cuZXh0ZXJuYWwubm90aWZ5KGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgTm9kZVRyYWZmaWNXb3JrZXIucHJvdG90eXBlLkluYm91bmRFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdmFyIHBhcnNlZEV2ZW50ID0gSlNPTi5wYXJzZShldmVudCk7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLm9uRXZlbnRSZWNlaXZlZC5jYWxsKHRoaXMsIHBhcnNlZEV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE5vZGVUcmFmZmljV29ya2VyO1xuICAgIH0oV2FwQ29tLlRyYWZmaWNXb3JrZXIpKTtcbiAgICBXYXBDb20uTm9kZVRyYWZmaWNXb3JrZXIgPSBOb2RlVHJhZmZpY1dvcmtlcjtcbn0pKFdhcENvbSB8fCAoV2FwQ29tID0ge30pKTtcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9Db250cmFjdC9JVHJhZmZpY1dvcmtlci50c1wiIC8+XG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiVHJhZmZpY3dvcmtlci50c1wiIC8+XG52YXIgV2FwQ29tO1xuKGZ1bmN0aW9uIChXYXBDb20pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIFN0YW5kYWxvbmVUcmFmZmljV29ya2VyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFN0YW5kYWxvbmVUcmFmZmljV29ya2VyLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBTdGFuZGFsb25lVHJhZmZpY1dvcmtlcih0cmFmZmljU2V0dGluZ3MpIHtcbiAgICAgICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIHRyYWZmaWNTZXR0aW5ncyk7XG4gICAgICAgIH1cbiAgICAgICAgU3RhbmRhbG9uZVRyYWZmaWNXb3JrZXIucHJvdG90eXBlLk91dGJvdW5kRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgfTtcbiAgICAgICAgU3RhbmRhbG9uZVRyYWZmaWNXb3JrZXIucHJvdG90eXBlLkluYm91bmRFdmVudCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gU3RhbmRhbG9uZVRyYWZmaWNXb3JrZXI7XG4gICAgfShXYXBDb20uVHJhZmZpY1dvcmtlcikpO1xuICAgIFdhcENvbS5TdGFuZGFsb25lVHJhZmZpY1dvcmtlciA9IFN0YW5kYWxvbmVUcmFmZmljV29ya2VyO1xufSkoV2FwQ29tIHx8IChXYXBDb20gPSB7fSkpO1xuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uLy4uL0Vudmlyb25tZW50LnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi8uLi9Nb2RlbHMvRW51bXMudHNcIiAvPlxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3RyYWZmaWN3b3JrZXJzL25vZGV0cmFmZmljd29ya2VyLnRzXCIgLz5cbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi90cmFmZmljd29ya2Vycy9zdGFuZGFsb25ldHJhZmZpY3dvcmtlci50c1wiIC8+XG52YXIgV2FwQ29tO1xuKGZ1bmN0aW9uIChXYXBDb20pIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgdmFyIFRyYWZmaWNNYW5hZ2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVHJhZmZpY01hbmFnZXIodHJhZmZpY1NldHRpbmdzKSB7XG4gICAgICAgICAgICB0aGlzLldvcmtlciA9IHRoaXMuU2V0RW52aXJvbm1lbnRXb3JrZXIodHJhZmZpY1NldHRpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICBUcmFmZmljTWFuYWdlci5wcm90b3R5cGUuU2VuZEV2ZW50ID0gZnVuY3Rpb24gKGtleSwgZXZlbnRPYmplY3QpIHtcbiAgICAgICAgICAgIHZhciBldmVudCA9IHRoaXMuQ3JlYXRlRXZlbnQoa2V5LCBldmVudE9iamVjdCk7XG4gICAgICAgICAgICB0aGlzLldvcmtlci5PdXRib3VuZEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgVHJhZmZpY01hbmFnZXIucHJvdG90eXBlLlJlcXVlc3RGb2N1cyA9IGZ1bmN0aW9uIChzZXZlcml0eSkge1xuICAgICAgICAgICAgdmFyIGV2ZW50ID0gdGhpcy5DcmVhdGVFdmVudChUcmFmZmljTWFuYWdlci5fZm9jdXNSZXF1ZXN0UGFyYW1ldGVyLCBzZXZlcml0eSk7XG4gICAgICAgICAgICB0aGlzLldvcmtlci5PdXRib3VuZEV2ZW50KGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgVHJhZmZpY01hbmFnZXIucHJvdG90eXBlLkNyZWF0ZUV2ZW50ID0gZnVuY3Rpb24gKGtleSwgZXZlbnRPYmplY3QpIHtcbiAgICAgICAgICAgIHZhciBldmVudCA9IG5ldyBXYXBDb20uRXZlbnQoa2V5LCBldmVudE9iamVjdCk7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICBUcmFmZmljTWFuYWdlci5wcm90b3R5cGUuU2V0RW52aXJvbm1lbnRXb3JrZXIgPSBmdW5jdGlvbiAodHJhZmZpY1NldHRpbmdzKSB7XG4gICAgICAgICAgICByZXR1cm4gKFdhcENvbS5FbnZpcm9ubWVudC5nZXRJbnN0YW5jZSgpLkN1cnJlbnRFbnZpcm9ubWVudCA9PSBFbnZpcm9ubWVudHMuTm9kZSkgP1xuICAgICAgICAgICAgICAgIG5ldyBXYXBDb20uTm9kZVRyYWZmaWNXb3JrZXIodHJhZmZpY1NldHRpbmdzKSA6XG4gICAgICAgICAgICAgICAgbmV3IFdhcENvbS5TdGFuZGFsb25lVHJhZmZpY1dvcmtlcih0cmFmZmljU2V0dGluZ3MpO1xuICAgICAgICB9O1xuICAgICAgICBUcmFmZmljTWFuYWdlci5fZm9jdXNSZXF1ZXN0UGFyYW1ldGVyID0gXCJGb2N1c1JlcXVlc3RcIjtcbiAgICAgICAgcmV0dXJuIFRyYWZmaWNNYW5hZ2VyO1xuICAgIH0oKSk7XG4gICAgV2FwQ29tLlRyYWZmaWNNYW5hZ2VyID0gVHJhZmZpY01hbmFnZXI7XG59KShXYXBDb20gfHwgKFdhcENvbSA9IHt9KSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
